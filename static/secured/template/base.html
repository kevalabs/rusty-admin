<!DOCTYPE html>
<html lang="en" data-theme="default">
<head>
    <meta name="description" content="rust-htmx">
    <!-- Open Graph Meta-->
    <title>Rust , Actix, Akasma</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <!-- Theme CSS-->
    <link rel="stylesheet" type="text/css" href="/css/themes/default.css" id="theme-css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/v/bs5/dt-1.13.4/datatables.min.css">
    {% block extra_css %}{% endblock %}
</head>
<body class="app sidebar-mini">
<!-- Navbar-->
<header class="app-header">
    <a class="app-header__logo" href="/dashboard" id="app-logo">
        <span id="logo-text">Admin App</span>
        <img id="logo-image" src="" alt="Logo" style="display: none; height: 40px;">
    </a>
    <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar"
                                    aria-label="Hide Sidebar"></a>
    <!-- Navbar Right Menu-->
    <ul class="app-nav">
        <li class="app-search">
            <input class="app-search__input" type="search" placeholder="Search">
            <button class="app-search__button"><i class="bi bi-search"></i></button>
        </li>
        <!--Notification Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-bs-toggle="dropdown"
                                aria-label="Show notifications"><i class="bi bi-bell fs-5"></i></a>
            <ul class="app-notification dropdown-menu dropdown-menu-right">
                <li class="app-notification__title">You have 1 new notifications.</li>
                <div class="app-notification__content">
                    <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><i
                            class="bi bi-envelope fs-4 text-primary"></i></span>
                        <div>
                            <p class="app-notification__message">System sent you a test mail</p>
                            <p class="app-notification__meta">2 min ago</p>
                        </div>
                    </a>
                    </li>
                </div>
                <li class="app-notification__footer"><a href="/notifications">See all notifications.</a></li>
            </ul>
        </li>
        <!-- Theme Selector -->
        <li class="dropdown">
            <a class="app-nav__item" href="#" data-bs-toggle="dropdown" aria-label="Change Theme">
                <i class="bi bi-palette fs-5"></i>
            </a>
            <ul class="dropdown-menu dropdown-menu-right">
                <li><h6 class="dropdown-header">Choose Theme</h6></li>
                <li><a class="dropdown-item theme-option" href="#" data-theme="default">
                    <i class="bi bi-circle-fill me-2" style="color: #00695C;"></i>Default
                </a></li>
                <li><a class="dropdown-item theme-option" href="#" data-theme="blue">
                    <i class="bi bi-circle-fill me-2" style="color: #1e3a8a;"></i>Blue Corporate
                </a></li>
                <li><a class="dropdown-item theme-option" href="#" data-theme="green">
                    <i class="bi bi-circle-fill me-2" style="color: #198754;"></i>Green Nature
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="/theme-settings">
                    <i class="bi bi-gear me-2"></i>Theme Settings
                </a></li>
            </ul>
        </li>
        <!-- User Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-bs-toggle="dropdown" aria-label="Open Profile Menu"><i
                class="bi bi-person fs-4"></i></a>
            <ul class="dropdown-menu settings-menu dropdown-menu-right">
                <li><a class="dropdown-item" href="page-user.html"><i class="bi bi-gear me-2 fs-5"></i> Settings</a>
                </li>
                <li><a class="dropdown-item" href="/profile"><i class="bi bi-person me-2 fs-5"></i> Profile</a>
                </li>
                <li><a class="dropdown-item" href="/logout"><i class="bi bi-box-arrow-right me-2 fs-5"></i>
                    Logout</a></li>
            </ul>
        </li>
    </ul>
</header>
<!-- Sidebar menu-->
<div class="app-sidebar__overlay" data-toggle="sidebar"></div>
<aside class="app-sidebar">
    <div class="app-sidebar__user"><img class="app-sidebar__user-avatar"
                                        src="https://randomuser.me/api/portraits/men/1.jpg" alt="User Image">
        <div>
            <p class="app-sidebar__user-name">John Doe</p>
            <p class="app-sidebar__user-designation">Admin</p>
        </div>
    </div>
    <ul class="app-menu">
        <li><a class="app-menu__item" href="/dashboard"><i class="app-menu__icon bi bi-speedometer"></i><span
                class="app-menu__label">Dashboard</span></a></li>

        <li><a class="app-menu__item" href="/users"><i class="app-menu__icon bi bi-people-fill"></i><span
                class="app-menu__label">Users</span></a></li>
<!--
        <li class="treeview"><a class="app-menu__item" href="#" data-toggle="treeview">
            <i class="app-menu__icon bi bi-people-fill"></i><span class="app-menu__label">Some Menu</span><i
                class="treeview-indicator bi bi-chevron-right"></i></a>
            <ul class="treeview-menu">
                <li><a class="treeview-item" href="/users"><i class="icon bi bi-search"></i>
                    Search</a></li>
            </ul>
        </li>
        -->
    </ul>
</aside>

<div class="app-content" id="main-content">
    <div class="app-title">
        {% block title %}{% endblock %}
    </div>
    {% block content %}{% endblock %}
</div>
<!-- Essential javascripts for application to work-->
<script src="/js/jquery-3.7.0.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>

<!-- Theme Management Script -->
<script>
    // Theme Management
    (function() {
        'use strict';
        
        const themes = {
            'default': {
                name: 'Default Theme',
                cssFile: '/css/themes/default.css',
                logo: 'Admin App'
            },
            'blue': {
                name: 'Blue Corporate',
                cssFile: '/css/themes/blue.css',
                logo: 'MBL Admin'
            },
            'green': {
                name: 'Green Nature',
                cssFile: '/css/themes/green.css',
                logo: 'Green Nature'
            }
        };
        
        // Load saved theme or default
        function loadTheme() {
            const savedTheme = localStorage.getItem('selectedTheme') || 'default';
            applyTheme(savedTheme);
        }
        
        // Apply theme
        function applyTheme(themeName) {
            const theme = themes[themeName];
            if (!theme) return;
            
            // Update CSS link
            const themeLink = document.getElementById('theme-css');
            if (themeLink) {
                themeLink.href = theme.cssFile;
            }
            
            // Update HTML data attribute
            document.documentElement.setAttribute('data-theme', themeName);
            
            // Update logo text
            const logoText = document.getElementById('logo-text');
            if (logoText) {
                logoText.textContent = theme.logo;
            }
            
            // Update active theme indicator
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
                if (option.getAttribute('data-theme') === themeName) {
                    option.classList.add('active');
                }
            });
            
            // Save to localStorage
            localStorage.setItem('selectedTheme', themeName);
            
            // Trigger custom event for theme change
            window.dispatchEvent(new CustomEvent('themeChanged', { 
                detail: { theme: themeName, config: theme } 
            }));
        }
        
        // Theme selection event handlers
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('theme-option') || e.target.closest('.theme-option')) {
                e.preventDefault();
                const themeOption = e.target.classList.contains('theme-option') ? 
                    e.target : e.target.closest('.theme-option');
                const selectedTheme = themeOption.getAttribute('data-theme');
                applyTheme(selectedTheme);
                
                // Show confirmation
                showThemeNotification(`Theme changed to ${themes[selectedTheme].name}`);
            }
        });
        
        // Show theme change notification
        function showThemeNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'alert alert-success position-fixed';
            notification.style.cssText = 'top: 70px; right: 20px; z-index: 9999; min-width: 250px;';
            notification.innerHTML = `
                <i class="bi bi-check-circle me-2"></i>${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }
        
        // Custom logo support
        function setCustomLogo(imageUrl, text) {
            const logoImage = document.getElementById('logo-image');
            const logoText = document.getElementById('logo-text');
            
            if (imageUrl) {
                logoImage.src = imageUrl;
                logoImage.style.display = 'inline-block';
                logoText.style.display = 'none';
            } else {
                logoImage.style.display = 'none';
                logoText.style.display = 'inline-block';
                if (text) logoText.textContent = text;
            }
        }
        
        // Expose functions globally for custom usage
        window.ThemeManager = {
            applyTheme: applyTheme,
            setCustomLogo: setCustomLogo,
            getCurrentTheme: () => localStorage.getItem('selectedTheme') || 'default',
            getAvailableThemes: () => themes
        };
        
        // Initialize theme on page load
        document.addEventListener('DOMContentLoaded', loadTheme);
        
    })();
</script>

<!-- Page specific javascripts-->
{% block scripts %}{% endblock %}
</body>
</html>